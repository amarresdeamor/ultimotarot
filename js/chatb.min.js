function actionbulleuser(idbox,iddate,callBack,userbox,dateuser,txtbulle,avecsex,txtpath){if("undefined"!=typeof txtbulle){var thisText="";thisText=void 0!==txtpath&&null!==txtpath?textchat.dialog.prospect[txtpath][txtbulle]:"undefined"!=typeof avecsex&&avecsex?textchat.dialog.prospect[valtutoie][txtbulle][valsexe]:textchat.dialog.prospect[valtutoie][txtbulle],void 0!=thisText&&""!=thisText&&(thisText=decodeText(typeTextChat,thisText),$("#"+txtbulle).html(thisText))}_.delay(function(){void 0!=callBack&&null!=callBack&&eval(callBack)},500/dividedTime);var now=moment().format("HH:mm");$(iddate).html(now),$(idbox+"_content").size()>0&&$(idbox).html($(idbox+"_content").html()),$(idbox+"_content").remove(),$(idbox).fadeIn(1e3/dividedTime,function(){$("html, body").animate({scrollTop:$(document).height()},{duration:1e3/dividedTime}),$("html, body").animate({scrollTop:$(document).height()},{duration:1e3/dividedTime}),$(userbox).delay(1e3/dividedTime).fadeIn("slow");var a=moment().format("HH:mm");$(dateuser).html(a),inactif()})}function validateTelephone(a){if(void 0==a||""==a)return!1;try{if(a=_.toString(a),void 0!=phoneUtils&&_.isObject(phoneUtils))return phoneUtils.isValidNumber(a,shortLocale)}catch(b){return"undefined"==typeof console?!1:(console.log(b),!1)}}function capitalize(a){return a.replace(/^(.{1})(.*)$/,function(a,b,c){return b.toUpperCase()+c})}function actionbulle(idbox,iddate,idtype,callBack,delay,txtbulle,avecsex,txtpath,specifictargettxtcontainer){if("undefined"!=typeof txtbulle){var thisText="",textContainerTarget=void 0!=specifictargettxtcontainer&&null!=specifictargettxtcontainer?specifictargettxtcontainer:"#"+txtbulle;thisText=void 0===txtpath||null===txtpath||"undefined"!=typeof avecsex&&avecsex?void 0!==txtpath&&null!==txtpath&&"undefined"!=typeof avecsex&&avecsex?textchat.dialog.robot[txtpath][txtbulle][valsexe]:"undefined"!=typeof avecsex&&avecsex?textchat.dialog.robot[valtutoie][txtbulle][valsexe]:textchat.dialog.robot[valtutoie][txtbulle]:textchat.dialog.robot[txtpath][txtbulle],void 0!=thisText&&""!=thisText?(thisText=decodeText(typeTextChat,thisText),$(textContainerTarget).html(thisText),void 0!=callBack&&null!=callBack&&eval(callBack),_.delay(function(){var a=moment().format("HH:mm");$(iddate).html(a),$(idbox).hide().fadeIn(delay/dividedTime,function(){$("html, body").animate({scrollTop:$(document).height()},{duration:1e3/dividedTime}),$(idtype).fadeIn(1e3/dividedTime,function(){$("html, body").animate({scrollTop:$(document).height()},{duration:1e3/dividedTime})})})},1e3)):void 0!=callBack&&null!=callBack&&eval(callBack)}}function addEvent(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,function(){return c.call(a,window.event)})}function init(){switch(dividedTime=isDevMode?4:1.5,$.ajax(urlLoadContentSentences).done(function(a){if(void 0==a&&null==a)throw Error("Can't retrieve content sentences.");contentSentences=a}).fail(function(a){throw Error("Can't retrieve content sentences.")}),shortLocale){case"US":visualizationDateFormat="mm/dd/yyyy";break;case"FR":case"ES":visualizationDateFormat="dd/mm/yyyy";break;default:visualizationDateFormat="dd/mm/yyyy"}$.when(loadDialog(),loadSequence()).done(function(){uiInit(),getProhibitWordList(),launchDialog()}).fail(function(){throw Error("Can't start chat because of ressource load error.")})}function loadDialog(){var a=$.ajax({url:urlLoadDialog,data:null,method:"GET",dataType:"json",success:function(a){if(void 0==a.type||""==a.type)throw Error("An error occured when retrieving dialog text");typeTextChat=CryptoJS.enc.Base64.parse(a.type),typeTextChat=CryptoJS.enc.Utf8.stringify(typeTextChat),textchat=a.content},error:function(){throw Error("Can't retrieve dialog text in langage: '"+locale+"' .")}});return a}function loadSequence(){var a=$.ajax({url:urlLoadSequence,data:null,method:"GET",dataType:"json",success:function(a){sequenceList=a},error:function(){throw Error("Can't retrieve sequence.")}});return a}function launchDialog(){if(void 0==textchat.redaction_en_cours||null==textchat.redaction_en_cours)throw Error("redaction_en_cours sentence not found in langage json file.");if(void 0==textchat.envoyer||null==textchat.envoyer)throw Error("envoyer sentence not found in langage json file.");if(void 0==textchat.lu||null==textchat.lu)throw Error("lu sentence not found in langage json file.");if(void 0==textchat.dialog||null==textchat.dialog)throw Error("dialog sentence not found in langage json file.");if(void 0==textchat.dialog.robot||null==textchat.dialog.robot)throw Error("dialog.robot sentence not found in langage json file.");if(void 0==textchat.dialog.prospect||null==textchat.dialog.prospect)throw Error("dialog.prospect sentence not found in langage json file.");readDialogSequence(sequenceList,1e3)}function readDialogSequence(a,b){var c=void 0!=b&&null!=b&&_.isInteger(b)?b:8e3;if(null==originalSequenceList&&(originalSequenceList=_.cloneDeep(a)),void 0==a||null==a)throw Error("No sequence found");var d=null;_.delay(function(){return 0==a.length?!1:(d=_.pullAt(a,0)[0],d.with_form=void 0==d.with_form||null==d.with_form?!1:d.with_form,d.form_options=void 0==d.form_options||null==d.form_options?{}:d.form_options,d.specific_dialog_options=void 0==d.specific_dialog_options||null==d.specific_dialog_options?{}:d.specific_dialog_options,displayDialogBox(d.id,d.with_gender,d.text_path,d.specific_dialog_options,d.with_form,d.form_options,d.callback),currentSequenceId=d.id,void(a.length>0&&!d.stop&&readDialogSequence(a)))},c/dividedTime)}function continueDialogSequence(a){a=void 0==a||null==a?2e3:a,readDialogSequence(sequenceList,a)}function repeatDialogSequence(a,b){sequenceList=_.concat(a,sequenceList),readDialogSequence(sequenceList,b)}function displayDialogBox(a,b,c,d,e,f,g){if(b=void 0==b||null==b?!1:b,e=void 0==e||null==e?!1:e,d=void 0==d||null==d?null:d,e&&(void 0==f||null==f))throw Error("Missing form mandatory options to display it");$("#taper"+a).size()>0&&$("#taper"+a).html(decodeText(typeTextChat,textchat.redaction_en_cours)+"<span>.</span><span>.</span><span>.</span>").fadeIn(1e3/dividedTime),_.delay(function(){var h=moment().format("HH:mm");if($("#date"+a).html(h),e)actionbulleuser("#box"+a,"#date"+a,g,f.user_box,f.date_user,f.txtbulle,b,c,g);else{var i=d.hasOwnProperty("is_container_displayed")&&null!=d.is_container_displayed?d.is_container_displayed:!0,j=d.hasOwnProperty("specific_css")&&null!=d.specific_css?d.specific_css:null;i||($("#box"+a).removeClass("anabellebox"),$("#box"+a).find("p.datechat").remove(),$("#box"+a).find("img.chatanabelle").remove()),null!=j&&(j=JSON.parse(j),$("#box"+a).css(j));var k=d.hasOwnProperty("specific_text_id")&&null!=d.specific_text_id?d.specific_text_id:"txt_"+a,l=d.hasOwnProperty("targeted_text_container_id")&&null!=d.targeted_text_container_id?d.targeted_text_container_id:null;$("#taper"+a).size()>0&&$("#taper"+a).fadeOut(1e3/dividedTime,function(){var d=a+1;$(this).hide(),actionbulle("#box"+a,"#date"+a,"#taper"+d,g,2e3/dividedTime,k,b,c,l)})}},2e3/dividedTime)}function uiInit(){for(var a=1;22>=a;a++)degree=10*a,$("#carte"+a).css("transform","rotate("+degree+"deg)");$("#inactif-user").html(contentSentences.inactif_user),$("#block-cookie").size()>0&&($("#block-cookie-txt").html(contentSentences.block_cookie),$("#block-cookie-details-txt").html(contentSentences.block_cookie_details)),$(".modal-footer .close-modal").html(contentSentences.close_modal),$("#cgv-modal-title").html(contentSentences.cgv_modal_title),$("#charte-modal-title").html(contentSentences.charte_modal_title)}function checkName(a){var b=!1;if(b.length<3)throw Error("NAME_TOO_SHORT");if(b=a.match(/^[a-zA-ZÃƒÂ©ÃƒÂ¨ÃƒÂ§oÃƒÂ\¶ÃƒÂ´ÃƒÂ\±\-éèõñà\s]+\s{0,5}$/i),!b)throw Error("NAME_CONTAINED_FORBIDDEN_CHARACTERS");return b}function getProhibitWordList(){null==prohibitWords&&$.ajax({url:urlLoadProhibVocabulary,data:null,method:"GET",dataType:"json",success:function(a){prohibitWords=a},error:function(){throw Error("Can't retrieve prohibit word list.")}})}function checkVocabulary(a,b){var c=!0;if(void 0==b&&(b=!1),a=a.trim(),void 0!=a&&""!=a&&null!=prohibitWords&&prohibitWords.length>0){var d=null;_.map(prohibitWords,function(e){return d=b?new RegExp("(\\s+"+e+"\\s+)|(^"+e+"\\s+)|("+e+"$)","ig"):new RegExp("^"+e+"$","ig"),null!=a.match(d)?void(c=!1):void 0})}if(!c)throw Error("PROHIBIT_WORD_FOUND")}function getAstroSigneAccordingToBirthdayDate(a){if(void 0==a||null==a)throw Error("No birthday date passed.");var b="",c=null,d="";a=moment(a,"DD/MM/YYYY","fr",!0);var e=a.month()+1,f=a.date();if(1==e&&f>=21||2==e&&18>=f?(c="txt_verseau",d="m"):2==e&&f>=19||3==e&&20>=f?(c="txt_poissons",d="m"):3==e&&f>=21||4==e&&20>=f?(c="txt_belier",d="m"):4==e&&f>=21||5==e&&21>=f?(c="txt_taureau",d="m"):5==e&&f>=22||6==e&&21>=f?(c="txt_gemeaux",d="m"):6==e&&f>=22||7==e&&22>=f?(c="txt_cancer",d="m"):7==e&&f>=23||8==e&&22>=f?(c="txt_lion",d="m"):8==e&&f>=23||9==e&&22>=f?(c="txt_vierge",d="f"):9==e&&f>=23||10==e&&22>=f?(c="txt_balance",d="f"):10==e&&f>=23||11==e&&22>=f?(c="txt_scorpion",d="m"):11==e&&f>=23||12==e&&21>=f?(c="txt_sagittaire",d="m"):(12==e&&f>=22||1==e&&20>=f)&&(c="txt_capricorne",d="m"),null==c)throw Error("No Astologic sign found.");return b+=decodeText(typeTextChat,textchat.dialog.robot[valtutoie].txt_16),b+=" "+decodeText(typeTextChat,textchat.dialog.robot.general.txt_17[d]),b+=" "+decodeText(typeTextChat,textchat.dialog.robot.signe_astro[c].signe),b+=" "+getName(),b+=" :) "+decodeText(typeTextChat,textchat.dialog.robot.signe_astro[c].interpretation[valsexe])}function displayFormText(a){switch(a){case"sex":$("#txt_sexe").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_sex)),$("#gender-label-man").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_form_genre.m)),$("#gender-label-woman").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_form_genre.f));break;case"name":$("#txt_prenom").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_prenom));break;case"telephone":$("#confirm-tel-txt").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_telephone)),""!=valtelephone&&$("#confirmtel").val(valtelephone);break;case"tutoie":$("#tutoie-label-yes").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_form_tutoiement.tu)),$("#tutoie-label-no").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_form_tutoiement.vous));break;case"question":$("#question").attr("placeholder",decodeText(typeTextChat,textchat.dialog.prospect.txt_form_question[valtutoie]))}}function getAstroSigneSentence(){return getAstroSigneAccordingToBirthdayDate(valbirthday)}function initFormProspect(){$(".prospect-email-txt").html(decodeText(typeTextChat,textchat.dialog.robot.general.txt_prospect_email)),$(".prospect-phone-txt").html(decodeText(typeTextChat,textchat.dialog.robot.general.txt_prospect_telephone)),$(".prospect-read-txt").html(decodeText(typeTextChat,textchat.dialog.robot.general.txt_prospect_read)),$(".prospect-cgv-link-txt").html(decodeText(typeTextChat,textchat.dialog.robot.general.txt_prospect_cgv_link)),$(".prospect-mandatory-txt").html(decodeText(typeTextChat,textchat.dialog.robot.general.txt_prospect_mandatory)),$(".prospect-site-txt").html(decodeText(typeTextChat,textchat.dialog.robot.general.txt_prospect_site)),$(".prospect-invalid-phone-txt").html(decodeText(typeTextChat,textchat.dialog.robot.error.txt_numero_invalide[valtutoie])),$(".prospect-accept-contact-txt").size()>0&&$(".prospect-accept-contact-txt").html(decodeText(typeTextChat,textchat.dialog.robot.general.txt_prospect_accept_contact)),$("#formprospect").ajaxForm(optionsProspectForm),$("#chatanabelle__token").retrieveToken()}function getName(){var a=$("#prenom").size()>0?$("#prenom").val():"";return a=capitalize(a),a=a.trim()}function endDialog(){$("#mentions-txt").html(decodeText(typeTextChat,textchat.dialog.robot.general.txt_mentions)),$("#mentions-txt-link").html(decodeText(typeTextChat,textchat.dialog.robot.general["txt_mentions-link"])),$(".mentionsextra").fadeIn(),$("body").width()>768&&$("body,html").css("overflow","hidden"),_.delay(function(){currentSequenceId&&$("#taper"+currentSequenceId).fadeOut(1e3/dividedTime)},1e3)}function getSelectedCardsSentence(){var a="";if(selectedCardKeyList.length>0){var b="";_.forEach(selectedCardKeyList,function(c,d){if(b="txt_"+c,textchat.dialog.robot.tirage_carte.hasOwnProperty(b))switch(selectedCardKeyList.length){case 1:a=decodeText(typeTextChat,textchat.dialog.robot.tirage_carte[b].nom);break;case 2:0==d?a=decodeText(typeTextChat,textchat.dialog.robot.tirage_carte[b].nom):a+=" "+decodeText(typeTextChat,textchat.dialog.robot.general.txt_et)+" "+decodeText(typeTextChat,textchat.dialog.robot.tirage_carte[b].nom);break;default:a+=d==selectedCardKeyList.length-2?decodeText(typeTextChat,textchat.dialog.robot.tirage_carte[b].nom):d==selectedCardKeyList.length-1?" "+decodeText(typeTextChat,textchat.dialog.robot.general.txt_et)+" "+decodeText(typeTextChat,textchat.dialog.robot.tirage_carte[b].nom):decodeText(typeTextChat,textchat.dialog.robot.tirage_carte[b].nom)+", "}})}return a="<b>"+a+"</b>"}function rot13(a){return null!=a&&void 0!=a&&(a=a.replace(/[a-zA-Z]/g,function(a){return String.fromCharCode(("Z">=a?90:122)>=(a=a.charCodeAt(0)+13)?a:a-26)})),a}function decodeText(a,b){if(void 0==a||null==a||""==a)throw Error("decoding method not passed.");if(""==b)return b;switch(a){case"rot13":b=rot13(b);break;case"base64":b=CryptoJS.enc.Base64.parse(b),b=CryptoJS.enc.Utf8.stringify(b);break;case"mcrypt":throw Error(a+" not implemented yet.");default:throw Error("Unsupported type: "+a)}return b}var valtutoie="tu",sequenceList=[],valsexe="m",valbirthday="",valtelephone="",visualizationDateFormat="",selectedCardKeyList=new Array,optionsProspectForm=null,originalSequenceList=null,currentSequenceId=null,typeTextChat="",textchat={},prohibitWords=null,contentSentences={},dividedTime=1,MouseTrapEventList={},xhrRequest=null,errorIsLogged=!1;isDevMode=Boolean(isDevMode),isDevMode&&Routing.setBaseUrl("/app_dev.php");var ajoutroute=Routing.generate("ajouter"),urladd=Routing.generate("tarot_carte_voir"),urlcartes=Routing.generate("tarot_carte_liste"),urlsens=Routing.generate("tarot_carte_sens"),urlrappel=Routing.generate("tarot_carte_rappel"),urlLoadDialog=Routing.generate("get_chat_dialog"),urlLoadSequence=Routing.generate("get_chat_sequence"),urlLoadProhibVocabulary=Routing.generate("get_chat_prohibit_vocabulary"),urlLoadContentSentences=Routing.generate("get_chat_content_sentences"),getToken=Routing.generate("get_chat_token"),urlLogJsError=Routing.generate("log_js_error");window.onerror=function(a,b,c){if(errorIsLogged)return!1;var d={};return d.js_error={message:"message: "+a,url:"url: "+b,lineNumber:"line: "+c,user_navigator:"user navigator: "+navigator.userAgent},$.ajax({url:urlLogJsError,data:d,method:"post"}).success(function(a){return errorIsLogged=!0,"undefined"==typeof console?!1:void console.log(a)}).fail(function(d){"undefined"!=typeof console._commandLineAPI?consoleAPI=console._commandLineAPI:"undefined"!=typeof console._inspectorCommandLineAPI?consoleAPI=console._inspectorCommandLineAPI:"undefined"!=typeof console.clear&&(consoleAPI=console),consoleAPI.clear(),console.log("An error occured in JS:"),console.log(a),console.log(b),console.log(c)}),!0},$(function(){var a=1;$(window).load(function(){init()}),$(document).on("click","#sendfirst",function(){valsexe=$("input:radio[name=prospect_sexe]:checked").val(),$("#chatanabelle_sexe").val(valsexe),$(this).addClass("off").off("click"),$("#form1").fadeOut(function(){$(".legenre").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_genre[valsexe]))}),ga("send","event","choixsexe","click","sexe"),$("#envoi1").html(decodeText(typeTextChat,textchat.envoyer)).fadeIn().delay(1500).fadeOut(function(){$("#lu1").html(decodeText(typeTextChat,textchat.lu)).delay(500).fadeIn(),continueDialogSequence()})}),$(document).on("click","#sendsecond",function(){if(valprenom=getName($("#prenom").val()),0==valprenom.length)return!1;var a=_.words(valprenom);try{if(a.length>3)throw Error("TOO_MANY_WORDS_FOR_FIRSTNAME");checkName(valprenom),checkVocabulary(valprenom,!0),$("#form2").fadeOut(function(){$(".leprenomtext").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_prenom)+" "+valprenom),$(".leprenom").text(valprenom)}),$("#chatanabelle_firstname").val(valprenom),$(this).addClass("off").off("click"),ga("send","event","prenom","click","prenom"),$("#envoi2").html(decodeText(typeTextChat,textchat.envoyer)).fadeIn().delay(1500/dividedTime).fadeOut(function(){$("#lu2").html(decodeText(typeTextChat,textchat.lu)).delay(500).fadeIn(),continueDialogSequence()}),$(document).off("click","#sendsecond")}catch(b){$("#usersecond, #boxusersecond").fadeOut(function(){$("#prenom").val(""),"PROHIBIT_WORD_FOUND"==b.message?$("#box9").displayError("PROHIBIT_WORD_FOUND_IN_NAME",!0):$("#box9").displayError(b.message,!0)})}}),$(document).on("click","#sendtrois",function(){valtutoie=$("input:radio[name=prospect_tutoie]:checked").val(),$(this).addClass("off").off("click"),$("#form3").fadeOut(function(){$(".choixtutoie").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_tutoiement[valtutoie]))}),$("#chatanabelle_tutoie").val(valtutoie),ga("send","event","choixtutoie","click","tutoie"),$("#envoi3").html(decodeText(typeTextChat,textchat.envoyer)).fadeIn().delay(1500/dividedTime).fadeOut(function(){$("#lu3").html(decodeText(typeTextChat,textchat.lu)).delay(500).fadeIn(function(){continueDialogSequence()})}),$(document).off("click","#sendtrois")}),$(document).on("click","#sendquatre",function(){if(valbirthday=$("#birthday").val(),0===valbirthday.length)throw Error("Can't get birthday date");datenaissance=moment(valbirthday,"DD/MM/YYYY"),datenow=moment(),diffyears=datenow.diff(datenaissance,"years"),diffyears<18?$("#boxuserquatre").fadeOut(function(){$("#box13").displayError("NOT_ALLOW_FOR_MINOR",!1)}):($("#chatanabelle_birthday").val(valbirthday),$(this).addClass("off").off("click"),ga("send","event","anniversaire","click","anniversaire"),$("#form4").fadeOut(function(){hmtlbirthday=decodeText(typeTextChat,textchat.dialog.prospect.txt_birthday[valsexe])+" "+datenaissance.format(visualizationDateFormat.toUpperCase()),$(".datenaissance").html(hmtlbirthday)}),$("#envoi4").html(decodeText(typeTextChat,textchat.envoyer)).fadeIn().delay(1500/dividedTime).fadeOut(function(){$("#lu4").html(decodeText(typeTextChat,textchat.lu)).delay(5e3/dividedTime).fadeIn(function(){continueDialogSequence()})})),$(document).off("click","#sendquatre")}),$(document).on("click","#sendcinq",function(){try{if(valquestion=$("#question").val(),checkVocabulary(valquestion,!0),0===valquestion.length)return!1;if(activateQGControl){var a=_.words(valquestion.trim());if(a.length<3)throw Error("EXPLAIN_QUESTION_SENTENCE")}$("#chatanabelle_question").val(valquestion),$(this).addClass("off").off("click"),ga("send","event","laquestion","click","question"),$("#form5").fadeOut(function(){$(".maquestion").text(valquestion)}),$("#envoi5").html(decodeText(typeTextChat,textchat.envoyer)).fadeIn().delay(1500/dividedTime).fadeOut(function(){$("#lu5").html(decodeText(typeTextChat,textchat.lu)).delay(500).fadeIn(),continueDialogSequence()}),$(document).off("click","#sendcinq")}catch(b){$("#usercinq, #boxusercinq").fadeOut(function(){"PROHIBIT_WORD_FOUND"==b.message?$("#box23").displayError("PROHIBIT_WORD_FOUND_IN_QUESTION",!0):$("#box23").displayError(b.message,!0)})}}),optionsProspectForm={resetForm:!1,dataType:"json",beforeSubmit:function(a,b,c){$("#send6").prop("disabled",!0),$("#loading").show()},success:function(a,b,c,d){$("#loading").hide(),"false"==a.error?($("#confirmtel").val($("#formprospect #chatanabelle_phone_number").val()),valtelephone=$("#formprospect #chatanabelle_phone_number").val(),ga("send","event","formulaireqg","click","1erformulaire"),$("#formprospect").fadeOut(function(){$("#formvalue").html("<p>"+decodeText(typeTextChat,textchat.dialog.prospect.txt_email)+" "+$("#formprospect #chatanabelle_email").val()+"</p>"),""!=$("#formprospect #chatanabelle_phone_number").val()&&$("#formvalue").html($("#formvalue").html()+"<p>"+decodeText(typeTextChat,textchat.dialog.prospect.txt_telephone)+" "+$("#formprospect #chatanabelle_phone_number").val()+"</p>")}),$("#pixel-inclusion").html(a.tpl),$("#envoi6").html(decodeText(typeTextChat,textchat.envoyer)).fadeIn().delay(1500/dividedTime).fadeOut(function(){$("#lu6").html(decodeText(typeTextChat,textchat.lu)).delay(500).fadeIn(),continueDialogSequence()}),$(document).off("click","#send6")):($("#send6").prop("disabled",!1),$("html, body").animate({scrollTop:$(document).height()},{duration:1e3}),$("#output").html(a.tpl),$("#error-warning").html(decodeText(typeTextChat,textchat.dialog.robot.error.txt_error_list)),$("#error-email-required").html(decodeText(typeTextChat,textchat.dialog.robot.error.txt_email_required)),$("#error-email-invalid").html(decodeText(typeTextChat,textchat.dialog.robot.error.txt_email_invalid)),$("#error-email-inexistance").html(decodeText(typeTextChat,textchat.dialog.robot.error.txt_email_inexistance)),$("#error-phone-invalid").html(decodeText(typeTextChat,textchat.dialog.robot.error.txt_numero_invalide[valtutoie])),$("#error-condition-accepter").html(decodeText(typeTextChat,textchat.dialog.robot.error.txt_condition_accepter)),$("#error-condition-partenaire").html(decodeText(typeTextChat,textchat.dialog.robot.error.txt_condition_partenaire)))}},$(document).on("click",".clickcarte",function(b){$(".clickcarte").off("click");var c=$(this);$.ajax({type:"GET",url:urladd,data:{count:nbreCartes},beforeSend:function(a){void 0!=xhrRequest&&null!=xhrRequest?a.abort():(xhrRequest=a,c.css({"margin-top":"200px"}).fadeOut("slow",function(){c.removeClass("effet").css("z-index",0)}))}}).done(function(b){return void 0==_.find($(b),function(a,b){return $(a).hasClass("card-name")})?!1:(xhrRequest=null,$("#result"+nbretirage).html(b),nbretirage--,void(0===nbretirage&&($(document).off("click",".clickcarte"),$.ajax({type:"GET",url:urlcartes,data:{count:nbreCartes}}).done(function(b){selectedCardKeyList=b,1==a&&(ga("send","event","tirage","click","tirage"),a+=1),$("html, body").animate({scrollTop:$(document).height()},{duration:1e3}),_.delay(function(){continueDialogSequence(),$("html, body").animate({scrollTop:$(document).height()},{duration:1e3})},3e3/dividedTime)}))))})}),$(document).on("keyup blur focusin","#chatanabelle_phone_number",function(){""==$(this).val()||validateTelephone($(this).val())?($("#send6").removeClass("off").prop("disabled",!1),$(".prospect-invalid-phone-txt").hide()):($("#send6").addClass("off").prop("disabled",!0),$(".prospect-invalid-phone-txt").show())}),$(document).on("keyup blur focusin","#confirmtel",function(){testTel($(this).val())})}),$.fn.displayError=function(a,b){if(void 0==$(this))return!1;var c=$(this).attr("id").replace("box",""),d="",e="";b=void 0!=b&&null!=b&&_.isBoolean(b)?b:!0;var f=!b;switch(a){case"NAME_CONTAINED_FORBIDDEN_CHARACTERS":case"NAME_TOO_SHORT":case"TOO_MANY_WORDS_FOR_FIRSTNAME":d="txt_prenom_repeter",e="usersecond";break;case"PROHIBIT_WORD_FOUND_IN_NAME":d="txt_prohibit_word",e="usersecond";break;case"NOT_ALLOW_FOR_MINOR":d="txt_mineur",e="userquatre";break;case"PROHIBIT_WORD_FOUND_IN_QUESTION":d="txt_prohibit_word",e="usercinq";break;case"EXPLAIN_QUESTION_SENTENCE":d="txt_explain_question",e="usercinq"}if(""!=d){var g=_.find(originalSequenceList,function(a){return a.id===e}),h={id:c,stop:f,width_gender:!1,specific_dialog_options:{specific_text_id:d,targeted_text_container_id:"#txt_"+c},with_form:!1,callback:null,text_path:"error"},i=b?new Array(h,g):h;$(this).fadeOut(),repeatDialogSequence(i,1e3)}},$.fn.affichagecartes=function(){void 0!=$(this)?($(this).html($("#cartes").html()),$(this).parent().show().fadeIn(1e3/dividedTime)):$("#cartes").fadeIn(1e3/dividedTime),$("html, body").animate({scrollTop:$(document).height()},{duration:1e3}),setTimeout(function(){$(".clickcarte").css("transform","rotate(0deg)")},2e3/dividedTime),setTimeout(function(){for(var a=1;22>=a;a++)$("#carte"+a).removeClass("alignmiddle").animate({left:3.8*a+"%"},1200/dividedTime);$("html, body").animate({scrollTop:$(document).height()},{duration:1e3})},1e3/dividedTime)};var inactif=function(){setIdleTimeout(6e5),setAwayTimeout(12e6),document.onIdle=function(){void 0!=_contentSentences&&null!=contentSentences&&_contentSentences.hasOwnProperty("inactif_user")&&$("#div_idle").text(contentSentences.inactif_user),$("#div_idle").css("display","block")},document.onAway=function(){$(".chatbox").fadeOut(function(){$(".stopbox").fadeIn()})},document.onBack=function(a,b){a&&$("#div_idle").css("display","none")}},testTel=function(a){validateTelephone(a)?($("#telephoneinvalide").hide(function(){$(this).html("")}),$("#send7").removeClass("off"),$(document).off("click","#send7"),$(document).on("click","#send7",function(){$.ajax({type:"POST",url:urlrappel,data:{telephone:$("#confirmtel").val(),valtutoie:valtutoie}}).done(function(a){$("#content-rappel").html(a),$("#form7").fadeOut(function(){valtelephone=$("#confirmtel").val(),$(".letelephone").html(decodeText(typeTextChat,textchat.dialog.prospect.txt_appel[valtutoie])+" "+$("#confirmtel").val()),ga("send","event","rappel","click","formulairerappel"),goog_report_conversion()}),$("#envoi7").html(decodeText(typeTextChat,textchat.envoyer)).fadeIn().delay(1500/dividedTime).fadeOut(function(){$("#lu7").html(decodeText(typeTextChat,textchat.lu)).delay(5e3/dividedTime).fadeIn(function(){continueDialogSequence()})})})})):($("#send7").addClass("off"),$(document).off("click","#send7"),$("#telephoneinvalide").show(function(){texterreur=decodeText(typeTextChat,textchat.dialog.robot.error.txt_numero_invalide[valtutoie]),$(this).html(texterreur)}))};Date.prototype.dateAdd=function(a,b){b=parseInt(b);var c=0;switch(a){case"day":c=24*b,this.dateAdd("hour",c);break;case"hour":c=60*b,this.dateAdd("minute",c);break;case"week":c=7*b,this.dateAdd("day",c);break;case"minute":c=60*b,this.dateAdd("second",c);break;case"second":c=1e3*b,this.dateAdd("millisecond",c);break;case"month":b+=this.getUTCMonth(),b/12>0&&(this.dateAdd("year",b/12),b%=12),this.setUTCMonth(b);break;case"millisecond":this.setTime(this.getTime()+b);break;case"year":this.setFullYear(this.getUTCFullYear()+b);break;default:throw new Error("Invalid date increment passed")}},$.fn.initDateBirthday=function(){var a={limit_min_year:18,date_format:"dd/mm/yyyy",date_visalization_format:visualizationDateFormat},b=null,c=null;if(null==$(this))return!1;a.hasOwnProperty("limit_min_year")&&null!=a.limit_min_year?(c=moment().subtract(a.limit_min_year,"year"),c.date(1).month(0)):c=moment().date(1).month(0);var d=$("#chatanabelle_birthday").val();b=""!=d?d:c.format(a.date_format.toUpperCase()),a.default_date=b,$(this).initDatePick(a)},$.fn.initDatePick=function(a){(void 0==a||null==a)&&(a={});var b=a.hasOwnProperty("limit_min_year")&&void 0!=a.limit_min_year&&_.isInteger(a.limit_min_year)?a.limit_min_year:null,c=a.hasOwnProperty("date_format")&&void 0!=a.date_format&&""!=a.date_format?a.date_format:"dd/mm/yyyy",d=a.hasOwnProperty("date_visalization_format")&&void 0!=a.date_visalization_format&&""!=a.date_visalization_format?a.date_visalization_format:"dd/mm/yyyy",e=a.hasOwnProperty("default_date")&&void 0!=a.default_date&&""!=a.default_date?a.default_date:null;if(null!=b)var f=moment().subtract(b,"year"),g=null;if(g=f.format("YYYY"),void 0!=$(this)&&$(this).dropdate({dateFormat:c,defaultDate:e,maxYear:g}),$("#boxuserquatre .dropdate-select").size()>0){var h=_.split(c,"/");if(h.length>0){var i=null,j="",k="";_.each(h,function(a,b){switch(j="",i=$("#boxuserquatre .dropdate-select").filter(function(a){return a==b}),i=i.children("option:first-of-type"),a){case"dd":k=a,j=decodeText(typeTextChat,textchat.dialog.prospect.txt_form_birthday.day);break;case"mm":k=a,j=decodeText(typeTextChat,textchat.dialog.prospect.txt_form_birthday.month);break;case"yyyy":k=a,j=decodeText(typeTextChat,textchat.dialog.prospect.txt_form_birthday.year);break;default:throw Error("Format not supported: "+a)}""!=j&&(i.text(j),i.parent().addClass(k))})}}if(1==$("#boxuserquatre .dropdate-select:last-of-type").size()){var l=$("#boxuserquatre .dropdate-select:last-of-type"),m=l.children("option"),n=_.pullAt(m,0)[0];m=_.reverse(m),l.empty(),l.append(n),l.append(m);var o=moment(e,"DD/MM/YYYY");null==e?$("#boxuserquatre .dropdate-select:last-of-type option:first-of-type").attr("selected","selected"):(_.each(h,function(a,b){var c=b+2;switch(a){case"dd":$("#boxuserquatre .dropdate-select:nth-child("+c+") option[value='"+o.date()+"']").attr("selected","selected");break;case"mm":var d=o.month()+1;$("#boxuserquatre .dropdate-select:nth-child("+c+") option[value='"+d+"']").attr("selected","selected");break;case"yyyy":$("#boxuserquatre .dropdate-select:nth-child("+c+") option[value='"+o.year()+"']").attr("selected","selected");break;default:throw Error("Format not supported: "+a)}}),$("#birthday").val(e))}var p=$(".boxselect select.dropdate-select");d=_.split(d,"/");var q=null;_.isArray(d)&&d.length>0&&_.map(d,function(a){q=_.find(p,function(b){return $(b).hasClass(a)}),$(".boxselect").append(q)})},$.fn.initMouseTrapEventListener=function(a){if(void 0!=$(this)&&!MouseTrapEventList.hasOwnProperty($(this).attr("id"))){Mousetrap($(this).get(0)).unbind(["enter"]);var b=Mousetrap($(this).get(0)).bind(["enter"],function(b,c){$(a).trigger("click")});MouseTrapEventList[$(this).attr("id")]=b}},$.fn.displayCardResults=function(){$(this).parent().show(),$(".borderresult").each(function(){var a=$(this).find("p.card-name").data("slug");$(this).find(".card-name").html(decodeText(typeTextChat,textchat.dialog.robot.tirage_carte["txt_"+a].nom))}),$("html, body").animate({scrollTop:$(document).height()},{duration:1e3}),void 0!=$(this)?$(this).html($("#cartesresults").html()):$("#cartesresults").show()},$.fn.displayCardDetails=function(){var a=$(this);$.ajax({type:"GET",url:urlsens,data:{valtutoie:valtutoie}}).done(function(b){_.delay(function(){ga("send","event","interpretation","click","interpretation"),testTel($("#confirmtel").val()),void 0!=a?a.html(b).fadeIn(800/dividedTime):$("#cartesdetails").html(b).fadeIn(800/dividedTime),$("#cartesdetails").show(),$("html, body").animate({scrollTop:$(document).height()},{duration:1e3}),a.parent().show(),a.find("div.illustrations").each(function(){var a=$(this).data("slug");$(this).find(".card-name").html(decodeText(typeTextChat,textchat.dialog.robot.tirage_carte["txt_"+a].nom)),$(this).find(".card-interpretation-txt").html(decodeText(typeTextChat,textchat.dialog.robot.tirage_carte["txt_"+a].interpretation[valtutoie]))}),$("#loop1").fadeIn("slow",function(){$("html, body").animate({scrollTop:$(document).height()},{duration:1e3}),setTimeout(function(){$("html, body").animate({scrollTop:$(document).height()},{duration:1e3}),$("#loop2").fadeIn("slow",function(){setTimeout(function(){$("html, body").animate({scrollTop:$(document).height()},{duration:1e3}),$("#loop3").fadeIn("slow",function(){_.delay(function(){a.css("min-height","600px"),continueDialogSequence(),$("html, body").animate({scrollTop:$(document).height()},{duration:1e3})},1e4/dividedTime)})},1e4/dividedTime)})},1e4/dividedTime)})},3e3/dividedTime)})},$.fn.retrieveToken=function(){var a=$(this);$.ajax(getToken).success(function(b){if(void 0==b||""==b)throw Error("Can't retrieve token.");return void 0!=a&&null!=a&&(a.is("input")?a.val(b):a.text(b)),b}).fail(function(){throw Error("Can't retrieve token.")})},$.fn.tellCardDraw=function(){$(this).fillFieldWithInfo(null,".",getSelectedCardsSentence),_.delay(function(){continueDialogSequence()},5e3/dividedTime)},$.fn.fillRappelTxt=function(){void 0!=$(this)&&($(this).html($("#rappel_section").html()),$(this).parent().show()),$("#rappel-1").html(decodeText(typeTextChat,textchat.dialog.robot[valtutoie].txt_rappel.p1)),$("#rappel-2").html(decodeText(typeTextChat,textchat.dialog.robot[valtutoie].txt_rappel.p2)),$("#rappel-3").html(decodeText(typeTextChat,textchat.dialog.robot[valtutoie].txt_rappel.p3))},$.fn.fillFieldWithInfo=function(a,b,c,d){
if(void 0==$(this))throw Error("No jquery target passed");d=null==d||void 0==d?!1:d,a=null==a||void 0==a?d?"":$(this).html():a,b=null==b||void 0==b?"":b;var e=c();$(this).html(a+" "+e+b)};